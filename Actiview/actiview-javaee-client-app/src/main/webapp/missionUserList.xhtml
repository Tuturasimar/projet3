<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/templates/default.xhtml">

	<ui:define name="content">

		<h2 class="text-center my-4">Liste des affectations de missions</h2>


		<div class="row d-flex justify-content-end">
			<div class="col-2 my-3 mx-0">
				<h:link outcome="createNewMissionUser.xhtml"
					class="btn btn-success w-100" value="Nouvelle affectation" />
			</div>
		</div>

		<h:form>
			<p:dataTable value="#{showMissionUserBean.missionsUser}"
				var="missionUser">
				<p:column>
					<f:facet name="header">Nom Prénom</f:facet>
				<p>#{missionUser.user.userData.lastname} </p> <p> #{missionUser.user.userData.firstname}</p>
				</p:column>

				<p:column>
					<f:facet name="header">Intitulé Mission</f:facet>
				#{missionUser.mission.labelActivity}
				</p:column>

				<p:column>
					<f:facet name="header">Date de début</f:facet>
					<h:outputText value="#{missionUser.mission.missionStart}">
						<f:convertDateTime type="localDate" pattern="dd/MM/yyyy" />
					</h:outputText>
				</p:column>

				<p:column>
					<f:facet name="header">Date de fin</f:facet>
					<h:outputText value="#{missionUser.mission.missionEnd}">
						<f:convertDateTime type="localDate" pattern="dd/MM/yyyy" />
					</h:outputText>
				</p:column>

				<p:column>
					<f:facet name="header">Statut</f:facet>
				#{missionUser.missionState.label}
				</p:column>

				<p:column>
					<f:facet name="header">TJM</f:facet>
				#{missionUser.adr}
				</p:column>

				<p:column>
					<f:facet name="header">Nouvelle valeur de TJM</f:facet>
					<h:inputText value="#{showMissionUserBean.adr}" class="w-75" />
				</p:column>

				<p:column>
					<f:facet name="header">Commandes</f:facet>
					<h:commandButton
						action="#{showMissionUserBean.editAdr(missionUser.id)}"
						value="Changer TJM" class="btn btn-primary my-1" />
					<h:commandButton
						action="#{showMissionUserBean.changeAffectation(missionUser.id)}"
						value="Désactiver"
						rendered="#{missionUser.missionState == showMissionUserBean.ACTIVE}"
						class="btn btn-danger" />
					<h:commandButton
						action="#{showMissionUserBean.changeAffectation(missionUser.id)}"
						value="Activer"
						rendered="#{missionUser.missionState == showMissionUserBean.INACTIVE}"
						class="btn btn-success w-100" />
				</p:column>

			</p:dataTable>
		</h:form>
	</ui:define>
</ui:composition>