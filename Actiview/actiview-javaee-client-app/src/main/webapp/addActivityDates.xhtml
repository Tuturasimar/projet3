<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">

<ui:composition template="/WEB-INF/templates/default.xhtml">
	<f:metadata>
		<f:viewParam name="id" />
		<f:event
			listener="#{registerActivityDateFromArBean.showArCalendar(id)}"
			type="preRenderView"></f:event>
	</f:metadata>

	<ui:define name="Entete">
		<h2 style="color: red">test des dates</h2>

	</ui:define>

	<ui:define name="content">

		<!-- Formulaire d'ajout d'activité -->
		<h:form rendered="#{showArBean.isArADraft()}">
			<h:selectOneMenu id="partDayMenu"
				value="#{registerActivityDateFromArBean.arDateVm.partOfDay}">
				<f:selectItems value="#{enumData.partDay}" var="enum"
					itemValue="#{enum}" itemLabel="#{enum.label}"></f:selectItems>
			</h:selectOneMenu>
			<h:selectOneMenu id="activityMenu"
				value="#{registerActivityDateFromArBean.arDateVm.activityId}">

				<f:selectItem itemLabel="-- Missions en cours --"
					itemDisabled="true" />
				<f:selectItems value="#{showActivityBean.missions}" var="mission"
					itemValue="#{mission.id}" itemLabel="#{mission.labelActivity}"></f:selectItems>

				<f:selectItem itemLabel="-- Formation en cours --"
					itemDisabled="true" />
				<f:selectItems value="#{showActivityBean.formations}"
					var="formation" itemValue="#{formation.id}"
					itemLabel="#{formation.labelActivity}"></f:selectItems>

				<f:selectItem itemLabel="-- Motif d'absence --" itemDisabled="true" />
				<f:selectItems value="#{showActivityBean.absences}" var="absence"
					itemValue="#{absence.id}" itemLabel="#{absence.labelActivity}"></f:selectItems>

				<f:selectItem itemLabel="-- Autres --" itemDisabled="true" />
				<f:selectItems value="#{showActivityBean.customActivities}"
					var="customActivity" itemValue="#{customActivity.id}"
					itemLabel="#{customActivity.labelActivity}"></f:selectItems>

			</h:selectOneMenu>
			<h:outputLabel value="Télétravail" for="remote" />
			<h:selectBooleanCheckbox id="remote"
				value="#{registerActivityDateFromArBean.arDateVm.remote}" />
			<p:datePicker id="datePicker"
				value="#{registerActivityDateFromArBean.arDateVm.date}"
				showIcon="true" />
			<h:commandButton id="addDate"
				action="#{registerActivityDateFromArBean.addDate()}"
				value="Ajouter l'activité">
				<!-- 				<f:ajax execute="@form" render="schedule" event="click"></f:ajax> -->
			</h:commandButton>
			<p:datePicker id="datePickerDateFirst"
				value="#{registerActivityDateFromArBean.arDateVm.dateFirst}"
				showIcon="true" />
			<p:datePicker id="datePickerDateLast"
				value="#{registerActivityDateFromArBean.arDateVm.dateLast}"
				showIcon="true" />
			<h:commandButton id="addRangeDate"
				action="#{registerActivityDateFromArBean.addRangeDate()}"
				value="Ajouter les activités">
				<!-- 				<f:ajax execute="@form" render="schedule" event="click"></f:ajax> -->
			</h:commandButton>
			<h:commandButton
				action="#{registerActivityDateFromArBean.addAllMonth()}"
				value="Remplir le mois">
			</h:commandButton>
			<h:commandButton
				action="#{registerActivityDateFromArBean.deleteAllExistingActivityDate()}"
				value="Vider le mois">
			</h:commandButton>
		</h:form>

		<!-- Affichage du calendrier -->
		<p:outputLabel
			value="CRA du mois de #{registerActivityDateFromArBean.arCalendarVM.createdAt.month}"></p:outputLabel>
		<p:growl id="messages" showDetail="true" />

		<p:schedule id="schedule"
			value="#{registerActivityDateFromArBean.calendar}"
			initialDate="#{registerActivityDateFromArBean.arCalendarVM.createdAt}"
			draggable="false" showHeader="false"></p:schedule>
		<!-- Affichage en tableau des dates (se rafraichit automatiquement) à remplacer par le calendrier !-->

		<h:form>
			<p:commandButton action="#{showArBean.arSentToValidation()}"
				value="Soumettre le CRA" rendered="#{showArBean.isArADraft()}" />
		</h:form>
	</ui:define>
</ui:composition>
</html>